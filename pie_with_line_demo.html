<!DOCTYPE html>
<html>
    <head>
        <title>Kendo UI Pie Demo</title>
        <link href="https://kendo.cdn.telerik.com/2020.3.1118/styles/kendo.common.min.css" rel="stylesheet">
        <link href="https://kendo.cdn.telerik.com/2020.3.1118/styles/kendo.default.min.css" rel="stylesheet">
        <script src="https://kendo.cdn.telerik.com/2020.3.1118/js/jquery.min.js"></script>
        <script src="https://kendo.cdn.telerik.com/2020.3.1118/js/kendo.all.min.js"></script>
    </head>
    <body>
        <div class="demo-section k-content wide">
            <div id="pie-chart"></div>
        </div>
        <script>
            var valTempCurr = 30;
            var valTempAlarm = 54;
            var valRemain = 100 - valTempCurr;
            var colorTemp = (valTempCurr < valTempAlarm) ? "green" : "red";

            var center;
            var radius;

            function createChart() {
                $("#pie-chart").kendoChart({
                    title: {
                        position: "top",
                        text: "temperature"
                    },
                    legend: {
                        visible: false
                    },
                    chartArea: {
                        background: ""
                    },
                    series: [{
                        type: "pie",
                        startAngle: 0,
                        data: [{
                            category: "filled",
                            value: valTempCurr,
                            color: colorTemp
                        }, {
                            category: "after alarm",
                            value: valRemain,
                            color: "#DDDDDD"
                        }, {
                            category: "empty",
                            value: 100,
                            color: "none"
                        }],
                        visual: function(e) {
                            center = e.center;
                            radius = e.radius;

                            return e.createVisual();
                        }
                    }],
                    render: function(e) {
                        var draw = kendo.drawing;
                        var geom = kendo.geometry;
                        var chart = e.sender;

                        // 0度是右水平線，順直針
                        var cornerRad = (180 + (180/100)*valTempAlarm) * Math.PI / 180;
                        var nx = Math.cos(cornerRad) * radius + center.x;
                        var ny = Math.sin(cornerRad) * radius + center.y;

                        var path = new draw.Path({
                        stroke: {
                          color: "#000",
                          width: 2,
                          dashType: "dash"
                        }
                        });                  
                        path.moveTo(center).lineTo(nx, ny, 0).close();
                        chart.surface.draw(path);
                    }
                });
            }

            $(document).ready(createChart);
            $(document).bind("kendo:skinChange", createChart);
        </script>
    </body>
</html>